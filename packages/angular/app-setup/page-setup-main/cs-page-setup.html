@let activePage = _currentPage();
<mat-toolbar class="cs-page-setup-toolbar cs-mat-buttons-small">
    <button mat-icon-button [disabled]="_disabled()"
        (click)="_onAddingClick($event)"><mat-icon>forms_add_on</mat-icon></button>
    @if(!_isValid()){
    <mat-icon class="invalid-form-button">warning</mat-icon>
    }@else{
    <button mat-icon-button class="save-button" [disabled]="_disableSave()"
        (click)="save()"><mat-icon>save</mat-icon></button>
    }
    @if(_canUndo()){
    <button mat-icon-button class="undo-button" (click)="undo()"><mat-icon>undo</mat-icon></button>
    }

    <span class="cs-page-setup-toolbar-spacer"></span>
    @if(activePage){
    <mat-button-toggle-group [(ngModel)]="viewMode" (ngModelChange)="onViewModeChanged($event)" aria-label="View Mode"
        class="cs-page-setup-toggle-group">
        <mat-button-toggle value="properties">Properties</mat-button-toggle>
        <mat-button-toggle value="sections">Sections</mat-button-toggle>
        <mat-button-toggle value="code">Code</mat-button-toggle>
    </mat-button-toggle-group>
    }
</mat-toolbar>
<cs-splitter unit="percent" class="cs-page-setup-splitter">
    <cs-splitter-pane [size]="20" class="cs-page-setup-list-area">
        <cs-selection-list-panel class="cs-page-setup-list-control" [dataSource]="pages.value()"
            [activateFirstItem]="true" displayMember="pageName" [multiple]="true" [showIndex]="true"
            [readOnly]="_readOnly()" [enableDrag]="true" [selectOnlyByCheckBox]="true"
            [currentChanging]="_currentChanging" (currentChanged)="_onCurrentPageChanged($event)">
        </cs-selection-list-panel>
    </cs-splitter-pane>
    <cs-splitter-pane [size]="80" class="cs-page-setup-area" [class.cs-page-setup-area-hasItems]="activePage" csAutoForm
        (initialized)="_onMainFormInitialized($event)">
        @if(activePage){
        <cs-form-section class="cs-page-area-content" [hidden]="viewMode!=='properties'" csFormControlName="properties">
            <cs-page-setup-properties (needRefresh)="_onPageNameChanged($event)"></cs-page-setup-properties>
        </cs-form-section>
        <page-setup-sections class="cs-page-area-content" csFormControlName="sections"
            [sectionHandler]="_sectionsHandelr" [hidden]="viewMode!=='sections'"></page-setup-sections>
        @defer (when viewMode==='code') {
        <cs-monaco-editor [hidden]="viewMode!=='code'" class="cs-page-area-content" csFormControlName="pageCode">
            <cs-monaco-editor-page key="code" [actions]="actions" language="typescript"
                label="Code"></cs-monaco-editor-page>
            <cs-monaco-editor-page key="styles" language="css" label="CSS"></cs-monaco-editor-page>
        </cs-monaco-editor>
        }
        }
    </cs-splitter-pane>
</cs-splitter>